<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel | Shalom System Solutions</title>
  <link rel="stylesheet" href="admin.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

<div class="admin-wrapper">

  <!-- ==================== LOGIN SCREEN ==================== -->
  <div id="loginBox" class="login-screen">
    <div class="login-card">
      <div class="login-logo">
        <div class="logo-circle">S</div>
        <h1>Shalom Admin</h1>
        <p>System Solutions Management</p>
      </div>

      <div class="login-form">
        <div class="input-group">
          <label>ğŸ‘¤ Username</label>
          <input id="user" type="text" placeholder="Enter username" autocomplete="username">
        </div>

        <div class="input-group">
          <label>ğŸ”’ Password</label>
          <input id="pass" type="password" placeholder="Enter password" autocomplete="current-password">
        </div>

        <button onclick="login()" class="btn-login">
          <span>Login to Dashboard</span>
          <span class="arrow">â†’</span>
        </button>

        <p id="err" class="error-message"></p>

        <div class="login-footer">
          
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== DASHBOARD ==================== -->
  <div id="dashboard" class="hidden">
    
    <!-- HEADER -->
    <header class="dashboard-header">
      <div class="header-left">
        <div class="logo-mini">S</div>
        <div>
          <h2>Admin Dashboard</h2>
          <p class="header-subtitle">Shalom System Solutions</p>
        </div>
      </div>
      <div class="header-right">
        <a href="index.html" class="btn-link">â† Back to Website</a>
        <button onclick="logout()" class="btn-logout">Logout</button>
      </div>
    </header>

    <!-- STATS CARDS -->
    <div class="stats-grid">
      <div class="stat-card stat-products">
        <div class="stat-icon">ğŸ“¦</div>
        <div class="stat-info">
          <h3 id="productCount">0</h3>
          <p>Total Products</p>
        </div>
      </div>

      <div class="stat-card stat-inquiries">
        <div class="stat-icon">ğŸ“§</div>
        <div class="stat-info">
          <h3 id="inquiryCount">0</h3>
          <p>Customer Inquiries</p>
        </div>
      </div>

      <div class="stat-card stat-available">
        <div class="stat-icon">âœ…</div>
        <div class="stat-info">
          <h3 id="availableCount">0</h3>
          <p>Available Products</p>
        </div>
      </div>
    </div>

    <!-- TABS NAVIGATION -->
    <div class="tabs-nav">
      <button class="tab-btn active" onclick="switchTab('products')" id="tabProducts">
        <span class="tab-icon">ğŸ“¦</span>
        <span>Products Management</span>
      </button>
      <button class="tab-btn" onclick="switchTab('inquiries')" id="tabInquiries">
        <span class="tab-icon">ğŸ“§</span>
        <span>Customer Inquiries</span>
      </button>
    </div>

    <!-- ==================== PRODUCTS TAB ==================== -->
    <div id="productsTab" class="tab-content active">
      
      <!-- ADD PRODUCT CARD -->
      <div class="content-card">
        <div class="card-header">
          <h3>â• Add New Product</h3>
          <button onclick="toggleAddForm()" class="btn-toggle" id="toggleBtn">
            <span id="toggleText">Hide Form</span>
          </button>
        </div>

        <div id="addProductForm" class="add-form">
          <div class="form-row">
            <div class="form-group">
              <label>Product Name *</label>
              <input id="pname" type="text" placeholder="e.g., Dell Laptop i5 8GB" required>
            </div>

            <div class="form-group">
              <label>Product Type *</label>
              <input id="ptype" type="text" placeholder="e.g., Laptop, Desktop, SSD" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Price (â‚¹) *</label>
              <input id="pprice" type="number" placeholder="e.g., 45000" required>
            </div>

            <div class="form-group">
              <label>Availability *</label>
              <select id="pavailability">
                <option value="Available">âœ… Available</option>
                <option value="Out of Stock">âŒ Out of Stock</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>Description *</label>
            <textarea id="pdesc" rows="3" placeholder="Product details and specifications..." required></textarea>
          </div>

          <div class="form-group">
            <label>Product Image *</label>
            <div class="file-upload-area" id="fileUploadArea">
              <input type="file" id="pimage" accept="image/*" onchange="handleFileSelect(this)">
              <div class="file-upload-content">
                <div class="upload-icon">ğŸ“·</div>
                <p class="upload-text">Click or drag image here</p>
                <p class="upload-hint">Supports: JPG, PNG, WEBP (Max 5MB)</p>
              </div>
              <div id="imagePreview" class="image-preview hidden">
                <img id="previewImg" src="" alt="Preview">
                <button onclick="clearImage()" class="btn-clear-image">âœ•</button>
              </div>
            </div>
          </div>

          <button onclick="addProduct()" class="btn-submit">
            <span>Add Product</span>
            <span class="btn-arrow">â†’</span>
          </button>
        </div>
      </div>

      <!-- PRODUCTS LIST CARD -->
      <div class="content-card">
        <div class="card-header">
          <h3>ğŸ“¦ All Products</h3>
          <div class="search-box">
            <input type="text" id="productSearch" placeholder="ğŸ” Search products..." onkeyup="filterProducts()">
          </div>
        </div>

        <div id="adminProducts" class="products-grid"></div>
      </div>
    </div>

    <!-- ==================== INQUIRIES TAB ==================== -->
    <div id="inquiriesTab" class="tab-content">
      
      <div class="content-card">
        <div class="card-header">
          <h3>ğŸ“§ Customer Inquiries</h3>
          <button onclick="clearInquiries()" class="btn-clear-all">
            <span>ğŸ—‘ï¸</span>
            <span>Clear All</span>
          </button>
        </div>

        <div id="adminInquiries" class="inquiries-list"></div>
      </div>
    </div>

  </div>

</div>

<script>
let products = JSON.parse(localStorage.getItem("products")) || [];
let inquiries = JSON.parse(localStorage.getItem("inquiries")) || [];

function login() {
  const username = document.getElementById('user').value.trim();
  const password = document.getElementById('pass').value.trim();
  const errMsg = document.getElementById('err');

  if (username === "shalom" && password === "shalom2026") {
    document.getElementById('loginBox').classList.add("hidden");
    document.getElementById('dashboard').classList.remove("hidden");
    updateStats();
    renderAdmin();
  } else {
    errMsg.textContent = "âŒ Invalid username or password";
    errMsg.style.display = "block";
    setTimeout(() => { errMsg.style.display = "none"; }, 3000);
  }
}

function logout() {
  if (confirm("Are you sure you want to logout?")) location.reload();
}

function switchTab(tab) {
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  document.getElementById('tab' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
  document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
  document.getElementById(tab + 'Tab').classList.add('active');
}

function toggleAddForm() {
  const form = document.getElementById('addProductForm');
  const btn = document.getElementById('toggleText');
  if (form.style.display === 'none') {
    form.style.display = 'block';
    btn.textContent = 'Hide Form';
  } else {
    form.style.display = 'none';
    btn.textContent = 'Show Form';
  }
}

function handleFileSelect(input) {
  const file = input.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = (e) => {
      document.getElementById('previewImg').src = e.target.result;
      document.getElementById('imagePreview').classList.remove('hidden');
      document.querySelector('.file-upload-content').style.display = 'none';
    };
    reader.readAsDataURL(file);
  }
}

function clearImage() {
  document.getElementById('pimage').value = '';
  document.getElementById('imagePreview').classList.add('hidden');
  document.querySelector('.file-upload-content').style.display = 'flex';
}

function addProduct() {
  const name = document.getElementById('pname').value.trim();
  const type = document.getElementById('ptype').value.trim();
  const price = document.getElementById('pprice').value.trim();
  const desc = document.getElementById('pdesc').value.trim();
  const availability = document.getElementById('pavailability').value;
  const file = document.getElementById('pimage').files[0];

  if (!name || !type || !price || !desc) {
    alert("âš ï¸ Please fill all required fields");
    return;
  }

  if (!file) {
    alert("âš ï¸ Please select a product image");
    return;
  }

  const reader = new FileReader();
  reader.onload = () => {
    products.push({
      id: Date.now(),
      name: name,
      type: type,
      price: price,
      description: desc,
      availability: availability,
      image: reader.result,
      createdAt: new Date().toISOString()
    });

    localStorage.setItem("products", JSON.stringify(products));
    
    document.getElementById('pname').value = "";
    document.getElementById('ptype').value = "";
    document.getElementById('pprice').value = "";
    document.getElementById('pdesc').value = "";
    document.getElementById('pavailability').value = "Available";
    clearImage();

    updateStats();
    renderAdmin();
    alert("âœ… Product added successfully!");
  };
  reader.readAsDataURL(file);
}

function deleteProduct(id) {
  if (!confirm("Are you sure you want to delete this product?")) return;
  products = products.filter(p => p.id !== id);
  localStorage.setItem("products", JSON.stringify(products));
  updateStats();
  renderAdmin();
}

function editProduct(id) {
  const product = products.find(p => p.id === id);
  const name = prompt("Product Name:", product.name);
  if (!name) return;
  const type = prompt("Product Type:", product.type);
  if (!type) return;
  const price = prompt("Price (â‚¹):", product.price);
  if (!price) return;
  const desc = prompt("Description:", product.description);
  if (!desc) return;
  const availability = confirm("Is this product available in stock?") ? "Available" : "Out of Stock";

  product.name = name;
  product.type = type;
  product.price = price;
  product.description = desc;
  product.availability = availability;
  
  localStorage.setItem("products", JSON.stringify(products));
  updateStats();
  renderAdmin();
  alert("âœ… Product updated successfully!");
}

function clearInquiries() {
  if (!confirm("âš ï¸ Clear ALL inquiries? This action cannot be undone.")) return;
  inquiries = [];
  localStorage.setItem("inquiries", JSON.stringify(inquiries));
  updateStats();
  renderAdmin();
}

function deleteInquiry(id) {
  if (!confirm("Delete this inquiry?")) return;
  inquiries = inquiries.filter(i => i.id !== id);
  localStorage.setItem("inquiries", JSON.stringify(inquiries));
  updateStats();
  renderAdmin();
}

function filterProducts() {
  const searchTerm = document.getElementById('productSearch').value.toLowerCase();
  const productCards = document.querySelectorAll('.product-item');
  productCards.forEach(card => {
    const text = card.textContent.toLowerCase();
    card.style.display = text.includes(searchTerm) ? 'flex' : 'none';
  });
}

function updateStats() {
  document.getElementById('productCount').textContent = products.length;
  document.getElementById('inquiryCount').textContent = inquiries.length;
  document.getElementById('availableCount').textContent = products.filter(p => p.availability === 'Available').length;
}

function renderAdmin() {
  const adminProducts = document.getElementById('adminProducts');
  const adminInquiries = document.getElementById('adminInquiries');

  if (products.length === 0) {
    adminProducts.innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">ğŸ“¦</div>
        <h4>No products yet</h4>
        <p>Add your first product using the form above</p>
      </div>`;
  } else {
    adminProducts.innerHTML = products.map(p => `
      <div class="product-item">
        <div class="product-image">
          <img src="${p.image}" alt="${p.name}">
          <span class="badge ${p.availability === 'Available' ? 'badge-success' : 'badge-danger'}">
            ${p.availability === 'Available' ? 'âœ…' : 'âŒ'} ${p.availability}
          </span>
        </div>
        <div class="product-details">
          <h4>${p.name}</h4>
          <p class="product-type">ğŸ“‹ ${p.type}</p>
          <p class="product-desc">${p.description}</p>
          <div class="product-footer">
            <span class="product-price">â‚¹${p.price}</span>
            <div class="product-actions">
              <button onclick="editProduct(${p.id})" class="btn-edit">âœï¸ Edit</button>
              <button onclick="deleteProduct(${p.id})" class="btn-delete">ğŸ—‘ï¸ Delete</button>
            </div>
          </div>
        </div>
      </div>`).join('');
  }

  if (inquiries.length === 0) {
    adminInquiries.innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">ğŸ“§</div>
        <h4>No inquiries yet</h4>
        <p>Customer inquiries will appear here</p>
      </div>`;
  } else {
    const sortedInquiries = [...inquiries].sort((a, b) => b.id - a.id);
    adminInquiries.innerHTML = sortedInquiries.map(i => `
      <div class="inquiry-item">
        <div class="inquiry-header">
          <div class="inquiry-user">
            <div class="user-avatar">${i.name.charAt(0).toUpperCase()}</div>
            <div class="user-info">
              <h4>${i.name}</h4>
              <p class="inquiry-phone">ğŸ“ ${i.phone}</p>
            </div>
          </div>
          <div class="inquiry-meta">
            <span class="inquiry-time">ğŸ• ${new Date(i.timestamp || i.id).toLocaleDateString()} ${new Date(i.timestamp || i.id).toLocaleTimeString()}</span>
            <button onclick="deleteInquiry(${i.id})" class="btn-delete-inquiry">ğŸ—‘ï¸</button>
          </div>
        </div>
        ${i.productDetails ? `
          <div class="inquiry-product">
            <div class="product-mini">
              <img src="${i.productDetails.image}" alt="${i.productDetails.name}">
              <div class="product-mini-info">
                <h5>ğŸ“¦ Interested Product</h5>
                <p><strong>${i.productDetails.name}</strong></p>
                <p class="mini-price">â‚¹${i.productDetails.price} â€¢ ${i.productDetails.type}</p>
              </div>
            </div>
          </div>` : i.product ? `
          <div class="inquiry-product-simple">
            <strong>ğŸ“¦ Product:</strong> ${i.product}
          </div>` : ''}
        ${i.message ? `
          <div class="inquiry-message">
            <strong>ğŸ’¬ Message:</strong>
            <p>${i.message}</p>
          </div>` : ''}
      </div>`).join('');
  }
}
</script>

</body>
</html>